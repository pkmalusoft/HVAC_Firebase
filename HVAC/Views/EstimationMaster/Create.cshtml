@model HVAC.Models.EstimationMaster
@{

    ViewBag.pTitle = "Estimation Master";
    ViewBag.pageTitle = "Setup";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script>

    function SaveEstimationMaster() {
        debugger;
        var id = 0;
        if ($('#ID').val() > 0) {
            id = $('#ID').val();

        }
        var protypeobj = {
            ID: id,
            CategoryID: $('#QEstimationCategoryID').val(),
            TypeName: $('#TypeName').val(),
            UnitID: $('#QUnitID').val(),
            CurrencyID: $('#QCurrencyID').val(),
            Qty: $('#Qty').val(),
            Remarks: $('#Remarks').val(),
            OrderNo :$('#OrderNo').val()
           
            

        }
        debugger;
        $.ajax({
            type: "POST",
            url: '/EstimationMaster/SaveEstimationMaster/',
            datatype: "html",
            data: { ProType: protypeobj },
            success: function (response) {
                if (response.status == "OK") {
                    Swal.fire("Save Status!", response.message, "success");
                    setTimeout(function () {
                        window.location.href = "/Estimationmaster/Index";
                    }, 100)


                }
                else {
                    Swal.fire("Save Status!", response.message, "warning");
                }


            }
        });
    }

    


</script>

<script>
    (function () {
        "use strict";
        window.addEventListener(
            "load",
            function () {
                var t = document.getElementsByClassName("needs-validation");
                Array.prototype.filter.call(t, function (e) {
                    e.addEventListener(
                        "submit",
                        function (t) {

                            if (false === e.checkValidity()) {
                                e.classList.add("was-validated");
                            }
                            else {
                                t.preventDefault();
                                t.stopPropagation();
                                e.classList.remove("was-validated");

                                SaveEstimationMaster();

                            }
                        },
                        !1
                    );
                });
            },
            !1
        );
    })(),
        $(document).ready(function () {

            if ($('#ID').val() > 0) {

                $('#QEstimationCategoryID').val($('#QEstimationCategoryID').attr('svalue')).trigger('change');
                $('#QCurrencyID').val($('#QCurrencyID').attr('svalue')).trigger('change');
                $('#QUnitID').val($('#QUnitID').attr('svalue')).trigger('change');
            }
        });
  

</script>


@using (Html.BeginForm("Create", "EstimationMaster", FormMethod.Post, new { enctype = "multipart/form-data", @class = "needs-validation ", @novalidate = "novalidate" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)

    <fieldset>
        <div id="alert" style="color:red;margin-left:7px;display:none">* Please fill mandatory fields</div>
        <div class="card">
            <div class="card-body">
                <div class="row">
                    <div class="col-md-2">
                        <label class="col-form-label">Category</label>
                        @Html.DropDownList("QEstimationCategoryID", new SelectList(ViewBag.EstimationCategory, "ID", "CategoryName"), "Select", new { @class = "form-select", @id = "QEstimationCategoryID" , @svalue=Model.CategoryID})
                    </div>
                    <div class="col-md-3">
                        <div class="mb-2">
                            @Html.HiddenFor(model => model.ID)
                            <label class="col-form-label">Type Name</label>
                            @Html.TextBoxFor(model => model.TypeName, new { @class = "form-control txttarget", @autocomplete = "off", @required = "required" })
                            @Html.ValidationMessageFor(model => model.TypeName)

                            <div class="invalid-feedback">
                                Please Estimation Type
                            </div>
                        </div>
                    </div>
                    <div class="col-md-1">
                        <label class="col-form-label">Currency</label>
                        @Html.DropDownList("QCurrencyID", new SelectList(ViewBag.Currency, "CurrencyID", "CurrencyCode"), "Select", new { @class = "form-select", @id = "QCurrencyID",@svalue=Model.CurrencyID })
                    </div>
                    <div class="col-md-2">
                        <label class="col-form-label">Unit Type</label>
                        @Html.DropDownList("QUnitID", new SelectList(ViewBag.Unit, "ItemUnitID", "ItemUnit1"), "Select", new { @class = "form-select", @id = "QUnitID",@svalue=Model.UnitID })
                    </div>
                    <div class="col-md-2">
                        <label class="col-form-label">Default Value</label>
                        @Html.TextBoxFor(model => model.Qty, new { @class = "form-control textright3", @autocomplete = "off" })
                    </div>
                    <div class="col-md-2">
                        <label class="col-form-label">Order No.</label>
                        @Html.TextBoxFor(model => model.OrderNo, new { @class = "form-control" })
                    </div>
                    <div class="col-md-2">
                        <label class="col-form-label">Remarks</label>
                        @Html.TextBoxFor(model => model.Remarks, new { @class = "form-control" })
                    </div>
                    <div class="col-md-12 text-md-end">
                        <input type="submit" value="Save" class="btn btn-success" id="btnsave" />



                        <a href='@Url.Action("Index", "EstimationMaster", new { id = 0 })' class="btn btn-secondary">Cancel</a>

                    </div>
                </div>
            </div>
        </div>
    </fieldset>


}
