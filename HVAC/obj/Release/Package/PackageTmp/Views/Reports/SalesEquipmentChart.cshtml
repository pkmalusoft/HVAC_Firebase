@using Newtonsoft.Json
@model  IEnumerable<HVAC.Models.QuotationStatusViewModel>
@{
    ViewBag.Title = "Sales Funnel Equipment";
    ViewBag.pTitle = "Reports";
    ViewBag.pageTitle = "HVAC";
    Layout = "~/Views/Shared/_Layout.cshtml";

    var funnelDataJson = JsonConvert.SerializeObject(Model);

}

@*<button onclick="printChart()"> Print Chart</button>
    <div id="container" style="height: 600px; width: 100%;"></div>*@
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/highcharts-3d.js"></script>
<script src="https://code.highcharts.com/modules/funnel.js"></script>

<div id="container" style="height: 300px; min-width: 210px"></div>

<script>
   var funnelData = [
        @foreach (var item in Model)
        {
            @: { name: "@item.name", y: @item.y, color: "@item.color" },
        }
    ];
    console.log(funnelData);
    document.addEventListener('DOMContentLoaded', function () {
        Highcharts.chart('container', {
            chart: {
                type: 'funnel',
                options3d: {
                    enabled: true,
                    alpha: 10,
                    depth: 50
                }
            },
            title: {
                text: 'Sales Funnel for Equipment Value (Values in USD)',
                style: {
                    fontWeight: 'bold',
                    fontSize: '20px'
                }
            },
            plotOptions: {
                series: {
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b> ({point.y:,.0f})',
                        softConnector: true
                    },
                    neckWidth: '00%',
                    neckHeight: '0%',
                    width: '80%',
                    height: '100%',
                    colors: funnelData.map(d => d.color), // per-slice colors
                }
            },
            series: [{
                name: 'Quotation Value',
                //data: funnelData
                data: funnelData.map(d => ({ name: d.name, y: d.y, color: d.color }))
            }]
        });
    });
</script>

