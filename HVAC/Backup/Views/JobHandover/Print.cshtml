@using System.Globalization
@model HVAC.Models.JobDetailsViewModel
@{
    Layout = null; // Print-friendly, no layout
    var i = 0;
}
@{
    var omrFormat = new CultureInfo("en-OM");
    omrFormat.NumberFormat.CurrencyDecimalDigits = 3;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Project Details</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            color: #333;
        }
        /* The main table to hold the two columns */
        .pdf-container-table {
            width: 100%;
            border-collapse: collapse; /* Removes spacing between cells */
        }

            .pdf-container-table td {
                vertical-align: top; /* Aligns content to the top of the cells */
                padding: 10px;
            }

        .left-panel, .right-panel {
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #f9f9f9;
        }

        .right-panel {
            margin-left: 20px; /* Adds a gap between the panels */
        }

        .panel h2 {
            margin-top: 0;
            color: #555;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
        }

        .details-table {
            width: 100%;
            border-collapse: collapse;
        }

            .details-table td {
                padding: 10px;
                border-bottom: 1px solid #eee;
            }

            .details-table tr:last-child td {
                border-bottom: none;
            }
        .string-item {
            display: block;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
            .string-item:last-child {
                border-bottom: none;
            }
        .value-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;

        }

            .value-item:last-child {
                border-bottom: none;
            }

        .total-value {
            font-weight: bold;
            font-size: 1.2em;
            color: #007bff;
        }

        .pdf-two-col {
            width: 100%;
            white-space: nowrap;
        }

        .pdf-col {
          /*  display: inline-block;*/
            vertical-align: top;
            width: 49%; /* Half width with slight margin */
            white-space: normal;
        }

        .pdf-col1 {
            display: inline-block;
            vertical-align: top;
            width: 70%; /* Half width with slight margin */
            white-space: normal;
        }

        .pdf-col2 {
            display: inline-block;
            vertical-align: top;
            width: 30%; /* Half width with slight margin */
            white-space: normal;
        }
        /* Cards & tables */
        .card {
            border-radius: 12px;
            box-shadow: 0 6px 16px #333;
            margin-bottom: 12px;
        }
        .card-body {
            flex: 1 1 auto;
            padding: 10px;
            /*color:darkgray;*/
        }

        .card-header {
            background: #cad4df;
            border-bottom: 1px solid #e9ecef;
        }

      
          /* This rule forces a new page before the content */
    @@media print {
        .page-break-container {
            page-break-before: always;
        }
        .no-print{
            display:none;
        }
    }
    </style>
</head>
<body>
    <div class="container">
        <!-- Top bar (hidden in print) -->
        <div class="d-flex justify-content-between align-items-center mb-3 no-print">
            <h4 class="m-0">Job Details</h4>
            <div class="d-flex gap-2">
                <a class="btn btn-outline-secondary" href="#">View</a>
                <a class="btn btn-primary" href="/JobHandover/PrintPdf?id=536">Download PDF</a>
            </div>
        </div>


        <div class="pdf-two-col">

            <div class="pdf-col1">
                <div class="card">
                    <div class="card-body">
                        <div class="card-header d-flex justify-content-between align-items-center" style="padding:10px;">
                            <h5>Project Information</h5>
                        </div>
                        <div class="string-item">
                            <span style="font-weight:bold">Project No.</span>
                            <span>@Model.Job.JobNo</span>
                        </div>
                        <div class="string-item">
                            <span style="font-weight:bold;margin-right:5px;">Project Title</span>
                            <span>@Model.Job.Title</span>
                        </div>
                        <div class="string-item">
                            <span style="font-weight:bold;margin-right:5px;">Customer Name:</span>
                            <span>@Model.Customer.Name</span>
                        </div>
                        <div class="string-item">
                            <span style="font-weight:bold;margin-right:5px;">Customer Location:</span>
                            <span>@Model.Customer.BillingAddress</span>
                        </div>
                        <div class="string-item">
                            <span style="font-weight:bold;margin-right:5px;">Project Start date</span>
                            <span>@Model.Job.StartDate.ToShortDateString() - </span>
                        </div>

                    </div>
                </div>
            </div>

            <div class="pdf-col2" style="margin-left:5px; ">
                <div class="card">
                    <div class="card-body">
                        <div class="card-header" style="padding:10px;">
                            <h5>Financial Overview</h5>
                        </div>
                        <div class="value-item">
                            <span style="font-weight:bold">Job Value:</span>
                            <span style="text-align:right">@string.Format(new CultureInfo("en-US"), "{0:C3}", @Model.Job.JobValue).Replace("$", "OMR ")</span>
                        </div>
                        <div class="value-item">
                            <span style="font-weight:bold">Cost Value:</span>
                            <span style="text-align:right">@string.Format(new CultureInfo("en-US"), "{0:C3}", @Model.Job.Cost).Replace("$", "OMR ")</span>
                        </div>
                        <div class="value-item">
                            <span style="font-weight:bold">VAT:</span>
                            <span style="display:flex;text-align:right">@string.Format(new CultureInfo("en-US"), "{0:C3}", @Model.Job.Vat).Replace("$", "OMR ")</span>
                        </div>
                        <div class="value-item">
                            <span style="font-weight:bold">Margin:</span>
                            <span style="text-align:right">@string.Format(new CultureInfo("en-US"), "{0:C3}", @Model.Job.Margin).Replace("$", "OMR ")</span>
                        </div>
                        <div class="value-item total-value">
                            <span style="font-weight:bold">Total Value:</span>
                            <span style="text-align:right">@string.Format(new CultureInfo("en-US"), "{0:C3}", @Model.Job.TotalValue).Replace("$", "OMR ")</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- PO Table -->


        <div class="pdf-two-col">
            <div class="card">
                <div class="card-body">
                    <div class="card-header" style="padding-top:5px;padding-bottom:5px;margin-bottom:5px">
                        <h5>Client PO List</h5>
                    </div>
                    <table class="table table-bordered" style="width:98%">
                        <thead class="table-light">
                            <tr>
                                <th>Var No.</th>
                                <th>PO No.</th>
                                <th>PO Date</th>
                                <th>Quotation No</th>
                                <th>Quotation Date</th>
                                <th>Order Value</th>
                                <th>VAT</th>
                                <th>Total</th>
                                <th>Created by</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model.PurchaseOrders)
                            {
                                <tr>
                                    <td>@item.VarNo</td>
                                    <td>@item.PONumber</td>
                                    <td>@item.PODate.ToShortDateString()</td>
                                    <td>@item.QuotationNo</td>
                                    <td>@item.QuotationDate.ToShortDateString()</td>
                                    <td style="text-align:right">@string.Format(new CultureInfo("en-US"), "{0:C3}", @item.OrderValue).Replace("$", "")</td>
                                    <td style="text-align:right">@item.VatPercent.ToString() %  @string.Format(new CultureInfo("en-US"), "{0:C3}", @item.VatAmount).Replace("$", " ")</td>
                                    <td style="text-align:right">@string.Format(new CultureInfo("en-US"), "{0:C3}", @item.TotalValue).Replace("$", "")</td>
                                    <td>@item.CreatedByName</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="pdf-two-col">


            <div class="card">
                <div class="card-body">
                    <div class="card-header" style="padding-top:5px;padding-bottom:5px;margin-bottom:5px">
                        <h5>Bond List</h5>
                    </div>
                    <table class="table table-bordered" id="ContainerTables">
                        <thead class="table-light">
                            <tr>
                                <th>S.No</th>
                                <th>Bond</th>
                                <th>Sales Value</th>
                                <th>Percentage</th>
                                <th>Bond Value</th>
                                <th>Issue Date</th>
                                <th>Validity</th>
                                <th>Expiry Date</th>




                            </tr>
                        </thead>
                        <tbody id="tbodyclient">

                            @foreach (var item in Model.BondDetails)
                            {
                                <tr id="trclient_@i">
                                    <td id="row_@i">
                                        @(i+1)
                                        @Html.HiddenFor(model => model.BondDetails[i].ID, new { @Value = @item.ID, @id = "hdnPOID_" + @i })
                                        @Html.HiddenFor(model => model.BondDetails[i].JobHandOverID, new { @Value = @item.JobHandOverID, @id = "hdnJobHandOverID_" + @i })
                                    </td>
                                    <td>
                                        @item.BondName
                                    </td>
                                    <td style="text-align:right">
                                        @HVAC.Models.CommonFunctions.GetBranchFormatNumber(@item.SalesValue, "3")
                                    </td>
                                    <td style="text-align:right">
                                        @item.Percentage
                                    </td>
                                    <td style="text-align:right">
                                        @HVAC.Models.CommonFunctions.GetBranchFormatNumber(@item.BondValue, "3")

                                    </td>
                                    <td>
                                        @item.BondIssueDate.ToShortDateString()
                                    </td>
                                    <td>
                                        @item.BondValidity
                                    </td>
                                    <td>
                                        @item.BondExpiryDate.ToShortDateString()
                                    </td>


                                </tr>
                                i++;
                            }
                        </tbody>
                    </table>

                </div>
            </div>
        </div>
        <div class="pdf-two-col">
            <div class="card">
                <div class="card-body">
                    <div class="card-header" style="padding-top:5px;padding-bottom:5px;margin-bottom:5px">
                        <h5>Warranty List</h5>
                    </div>
                    <table class="table table-bordered" id="DetailTable2" style="width: 100% !important;">

                        <thead class="table-light" style="text-align:center">
                            <tr>

                                <th width="10%">Equipment Name</th>
                                <th width="10%">Warranty</th>
                                <th width="75%">Description</th>


                            </tr>
                        </thead>
                        <tbody class="" style="text-align:center">

                            @foreach (var item1 in Model.WarrantyDetails)
                            {

                                <tr id="quodtr_@i">

                                    <td style="text-align:left">
                                        @Html.HiddenFor(modelitem => item1.ID, new { @id = "QWarrantyID_" + @i, @class = "form-control", @readonly = "readonly" })


                                        @Html.HiddenFor(modelitem => item1.EquipmentID, new { @id = "QWarrantyEquipmentID_" + @i, @class = "form-control", @readonly = "readonly" })


                                        @Html.HiddenFor(modelitem => item1.EquipmentName, new { @id = "txtEquipmentName2_" + @i, @class = " form-control-sm", @style = "width:200px" })

                                        <span id="QWarrantyEquipment_@i">@item1.EquipmentName</span>

                                    </td>
                                    <td style="text-align:left">
                                        @Html.HiddenFor(modelitem => item1.WarrantyType, new { @id = "txtWarranty_" + @i, @class = " form-control-sm", @style = "width:100%" })
                                        <span id="Qwarrantytype_@i">@item1.WarrantyType</span>
                                    </td>
                                    <td style="text-align:left" class="editable">


                                        @Html.HiddenFor(modelitem => item1.Description, new { @id = "QtxtWarrantyDescription_" + @i, @class = " form-control-sm", @style = "width:200px" })

                                        <span id="QwarrantyDescription_@i">@Html.Encode(@item1.Description)</span>

                                    </td>





                                </tr>
                                i++;
                            }
                        </tbody>

                    </table>
                </div>
            </div>
        </div>

        <div class="pdf-two-col">
            <div class="card">
                <div class="card-body">
                    <div class="card-header" style="padding-top:5px;padding-bottom:5px;margin-bottom:5px">
                        <h5>Costing List</h5>
                    </div>
                    <table class="table table-bordered" id="EstimationDetailTable" style="width: 100% !important;">

                        <thead class="table-light">
                            <tr>
                                <th width="20%">Estimation No.</th>
                                <th width="35%">Equipment/Description</th>
                                <th width="15%">Model/Unit</th>
                                <th width="5%">Unit</th>

                                <th width="5%">Qty</th>

                                <th width="5%">Rate</th>
                                <th>Value</th>

                            </tr>
                        </thead>
                        <tbody class="" style="text-align:left">


                            @foreach (var item1 in Model.Costing)
                            {
                                <tr id="quodtr_@i" class="@item1.displayclass">
                                    @*<td id="row_@i">@(i+1)</td>*@
                                    <td style="text-align:left">
                                        @Html.HiddenFor(modelitem => item1.EquipmentID, new { @id = "QEquipmentID_" + @i, @class = "form-control", @readonly = "readonly" })
                                        @Html.HiddenFor(modelitem => item1.EstimationCategoryID, new { @id = "QEstimationCategoryID_" + @i, @class = "form-control", @readonly = "readonly" })
                                        @Html.HiddenFor(modelitem => item1.EstimationMasterID, new { @id = "QEstimationMasterID_" + @i, @class = "form-control", @readonly = "readonly" })
                                        @Html.HiddenFor(modelitem => item1.Deleted, new { @id = "QDeleted_" + @i })
                                        @*@Html.HiddenFor(modelitem => item1.Roworder, new { @id = "QRoworder_" + @i })*@
                                        @Html.HiddenFor(modelitem => item1.UnitID, new { @id = "QUnitID_" + @i })
                                        @Html.HiddenFor(modelitem => item1.EstimationDetailID, new { @id = "QEstimationDetailID_" + @i })
                                        @Html.HiddenFor(modelitem => item1.EstimationID, new { @id = "QEstimationID_" + @i })
                                        @Html.HiddenFor(modelitem => item1.EstimationNo, new { @id = "QEstimationNo_" + @i })
                                        @Html.HiddenFor(modelitem => item1.CategoryName, new { @id = "QtxtCategoryName_" + @i, @class = " form-control-sm", @style = "width:200px" })

                                        @item1.CategoryName
                                        @{
                                            if (item1.EstimationNo != null)
                                            {
                                                <span style="color:blue">@item1.EstimationNo</span>
                                            }
                                        }

                                    </td>
                                    <td style="text-align:left">
                                        @Html.HiddenFor(modelitem => item1.Description, new { @id = "QtxtDescription_" + @i, @class = " form-control-sm", @style = "width:200px" })
                                        @item1.Description

                                    </td>
                                    <td class="editable" style="text-align:left">
                                        @Html.HiddenFor(modelitem => item1.Model, new { @id = "QtxtModel_" + @i, @class = "form-control-sm" })

                                        <span id="QspanModel_@i">@item1.Model</span>

                                    </td>
                                    <td>

                                        @item1.UnitName
                                        @Html.HiddenFor(modelitem => item1.UnitName, new { @id = "QUnitName_" + @i, @class = "form-control" })
                                    </td>

                                    <td style="text-align:right" class="editable">
                                        @Html.HiddenFor(modelitem => item1.Quantity, new { @id = "QtxtQty_" + @i, @class = "textright form-control-sm", @onchange = "calculatevalue(" + @i + ")", @style = "width:100px" })


                                        <span id="QspanQty_@i" style="color:dodgerblue">@HVAC.Models.CommonFunctions.GetBranchFormatNumber(item1.Quantity, "2")</span>

                                    </td>

                                    <td style="text-align:right" class="editable">
                                        @Html.HiddenFor(modelitem => item1.UnitRate, new { @Value = Convert.ToDecimal(item1.UnitRate).ToString("N2"), @id = "QtxtUnitRate_" + @i, @class = "textrightamount form-control-sm", @style = "width:100px", @onchange = "calculatevalue(" + @i + ")" })

                                        <span id="QspanRate_@i" style="color:dodgerblue">@HVAC.Models.CommonFunctions.GetBranchFormatNumber(item1.UnitRate, "3")</span>
                                    </td>
                                    <td style="text-align:right">
                                        @Html.HiddenFor(modelitem => item1.Amount, new { @Value = Convert.ToDecimal(item1.Amount).ToString("N3"), @id = "QtxtAmount_" + @i, @class = "textrightamount form-control-sm", @style = "width:100px", @readonly = "readonly" })
                                        <span id="QspanAmount_@i" style="color:dodgerblue">@HVAC.Models.CommonFunctions.GetBranchFormatNumber(item1.Amount, "3")</span>

                                    </td>


                                </tr>
                            }
                        </tbody>


                    </table>
                </div>
            </div>
        </div>
    </div>
           
</body>
</html>