@model HVAC.Models.RegisterReportModel
@{ ViewBag.Title = "Report";
    ViewBag.pTitle = @ViewBag.ReportName;
    ViewBag.pageTitle = "HVAC";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


@using (Html.BeginForm("ClientPORegister", "Reports", FormMethod.Post, new { @id = "customerledger" }))
{
    @Html.AntiForgeryToken()

    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    <div class="card">
        <div class="card-body">
            <div class="row align-items-end">
                <!-- From Date -->
                <div class="col-md-2">
                    <div class="mb-2" title="Select the period in which you wish to retrieve the data">
                        <label for="FromDate" class="control-label col-form-label">From Date</label>
                        <div class="docs-datepicker">
                            <div class="input-group">
                                <input type="text" class="form-control docs-date" name="FromDate" id="FromDate"
                                       value="@Model.FromDate.ToShortDateString()"
                                       placeholder="Pick a From Date" autocomplete="off" />
                                <button type="button" class="btn btn-secondary docs-datepicker-trigger" disabled>
                                    <i class="mdi mdi-calendar" aria-hidden="true"></i>
                                </button>
                            </div>
                            <div class="docs-datepicker-container"></div>
                        </div>
                    </div>
                </div>

                <!-- To Date -->
                <div class="col-md-2">
                    <div class="mb-2" title="Select the period in which you wish to retrieve the data">
                        <label for="ToDate" class="control-label col-form-label">To Date</label>
                        <div class="docs-datepicker">
                            <div class="input-group">
                                <input type="text" class="form-control docs-date" name="ToDate" id="ToDate"
                                       data-date-format="dd/MM/yyyy" data-date-autoclose="true" data-provide="datepicker"
                                       value="@Model.ToDate.ToShortDateString()"
                                       placeholder="Pick a date" autocomplete="off" />
                                <button type="button" class="btn btn-secondary docs-datepicker-trigger" disabled>
                                    <i class="mdi mdi-calendar" aria-hidden="true"></i>
                                </button>
                            </div>
                            <div class="docs-datepicker-container"></div>
                        </div>
                    </div>
                </div>

                <!-- Filter/Submit Button -->
                <div class="col-md-1">
                    <div class="mb-2 text-md-start">
                        <button type="submit" class="btn btn-success waves-effect waves-light filter btn_top reload" id="btnreport">
                            <i class="bx bx-revision" style="font-size: 21px;"></i>
                        </button>
                    </div>
                </div>

                <!-- Download Buttons -->
                <div class="col-md-7 text-md-end">
                    <a href="@Url.Action("ClientPORegisterExcel","Reports",new { fromDate = Model.FromDate, toDate = Model.ToDate })"
                       class="btn btn-success me-1">
                        <i class="fa fa-file-excel" style="font-size:18px"></i> Download Excel
                    </a>
                    <a href="@Url.Action("ClientPORegisterPrint","Reports",new { fromDate = Model.FromDate, toDate = Model.ToDate })"
                       class="btn btn-warning" target="_blank">
                        <i class="fa fa-file-pdf" style="font-size:18px"></i> Download PDF
                    </a>
                </div>
            </div>
            <div class="row">
                <div class="my-2 text-center">
                    <h3 id="reporttitle">ClientPO Register From @Model.FromDate.ToShortDateString() To @Model.ToDate.ToShortDateString()</h3>
                </div>
            </div>
            <table style="width:100%; border:1px solid #ddd; border-collapse:collapse; font-family:Arial, sans-serif; font-size:14px;">
                <thead>
                    <tr style="background:#808080;color:white; border-bottom:2px solid #fff;">
                        <th style="padding:8px; text-align:left;">Sl. No.</th>
                        <th style="padding:8px; text-align:left;">Client PO No.</th>
                        <th style="padding:8px; text-align:left;">PO Date</th>
                        <th style="padding:8px; text-align:left;">Client/Company</th>
                        <th style="padding:8px; text-align:left;">Project/Site</th>
                        <th style="padding:8px; text-align:left;">Enquiry No.</th>
                        <th style="padding:8px; text-align:left;">Quotation No.</th>
                        <th style="padding:8px; text-align:left;">Currency</th>
                        <th style="padding:8px; text-align:right;">PO Value</th>
                        <th style="padding:8px; text-align:right;">Tax %</th>
                        <th style="padding:8px; text-align:right;">Tax Amount</th>
                        <th style="padding:8px; text-align:right;">Net PO Value</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null && Model.Groups.Rows.Count > 0)
                    {
                        int i = 1;
                        foreach (System.Data.DataRow row in Model.Groups.Rows)
                        {
                            <tr style="border-bottom:1px solid #eee;">
                                <td style="padding:8px;">@i</td>
                                <td style="padding:8px; max-width:150px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">
                                    @(string.IsNullOrEmpty(row["Client PO No."].ToString()) ? "-" : row["Client PO No."].ToString())
                                </td> <td style="padding:8px; white-space:nowrap;">@row["PO Date"]</td>
                                <td style="padding:8px;">@row["Client/Company"]</td>
                                <td style="padding:8px;">@row["Project/Site"]</td>
                                <td style="padding:8px;">@row["Enquiry No."]</td>
                                <td style="padding:8px;">@row["Quotation No."]</td>
                                <td style="padding:8px;">@row["Currency"]</td>
                                <td style="padding:8px; text-align:right;">@row["PO Value"]</td>
                                <td style="padding:8px; text-align:right;">@row["Tax %"]</td>
                                <td style="padding:8px; text-align:right;">@row["Tax Amount"]</td>
                                <td style="padding:8px; text-align:right;">@row["Net PO Value"]</td>
                            </tr>
                            i++;
                        }

                        <!-- Optional: Total Row -->
                        <tr style="background:#a9a5a5; font-weight:bold; font-size:15px;">
                            <td colspan="11" style="padding:8px; text-align:right;">TOTAL </td>
                            <td style="padding:8px; text-align:right;">@Model.Groups.Rows.Count</td>
                        </tr>
                    }
                    else
                    {
                        <tr>
                            <td colspan="12" style="padding:8px; text-align:center; color:gray;">No data found</td>
                        </tr>
                    }
                </tbody>
            </table>


        </div>
    </div>
}

